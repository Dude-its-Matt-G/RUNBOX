<!doctype html>
<html lang="en">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Aldrich&&family=Epilogue:wght@500&family=Source+Code+Pro:wght@400&family=VT323&display=swap" rel="stylesheet">

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>RUNBOX</title>
    
    <!--CSS loading here-->
    <link rel="stylesheet" href="./bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="./RUNIFY/RUNIFY_Theme.css" />
    <link rel="stylesheet" href="./nav.css" />
    
    <!--Font loading here-->
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Share+Tech+Mono'>    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet"> 

    <!--Attempt to hide cursor-->
    <script type="text/javascript">
        document.getElementById('hide_id').style.cursor = 'none';
    </script>

    <!--THEME CONTROL - might put in its own JS file but for now its fine where it's at-->
    <script> 
        function setTheme(themeName) {
            localStorage.setItem('theme', themeName);
    //document.documentElement.className = themeName;

        var link = document.createElement('link');
        link.rel = 'stylesheet';
    if (themeName == "theme-dark") {
        link.href = './dark_RBSC.css';
    } else {
        link.href = './light_RBSC.css';
    }
        document.head.appendChild(link);
    }

    // function to toggle between light and dark theme
        function toggleTheme() {
    if (localStorage.getItem('theme') === 'theme-dark') {
        setTheme('theme-light');
    } else {
        setTheme('theme-dark');
    }
        }

    // Immediately invoked function to set the theme on initial load
    (function() {
    if (localStorage.getItem('theme') === 'theme-dark') {
        setTheme('theme-dark');
    } else {
        setTheme('theme-light');
    }
    })();
</script> 
</head>



<body>
    <div class="header">
        <div class="plastic-label">
            <div class="title" aria-hidden="true">
                <div class="model-wrapper">
                    <div class="model-main"><p class="top-name">RUNBOX</span></p></div>
                    <div class="model-sub"><p class="sub-type">SUPER CONTROLLER</span></p></div>
                </div>
                <div class="function-wrapper">
                    <div class="function-titles">
                        <div class="funct-child">USBHB</div>
                        <div class="funct-child">MUSIC</div>
                        <div class="funct-child">AUDIO</div>
                        <div class="funct-child">THEME</div>
                        <div class="funct-child">CONF</div>
                    </div>
                <div class="theme_button">
                    <button class="switch" id="switch">
                        <div id="hide_id"></div><a href="#USB">•</a></button>
                    <button class="switch" id="switch">
                        <div id="hide_id"></div><a href="#RUNIFY">•</a></button>
                    <button class="switch" id="switch">
                            <div id="hide_id"></div><a href="#AUDIO">•</a></button>
                    <button class="switch" id="switch" onclick="toggleTheme()">
                            <div id="hide_id"></div>•</button>
                    <button class="switch" id="switch">
                            <div id="hide_id"></div>•</button>
                    </div>
                    
                </div>
            </div>   
        </div>
    </div>
    <!--"APPS" such as USB control and Spotify wrapper. Anything else also goes after this line.-->
<article class="UBER-container-sect">
<div class="UBER-container-div">

    <!--BEGIN USB CONTROL-->
<section class="APP" id="USB">
<div class="USB">
    
    <div class="left-side">
    <div class="button-container">
    <p class="track-top">  control a  </p>
                                
    <div class="buttons"> 
                
      <div class="channel">
                <div class="inset">
                  <div class="port-no">1</div> 
                  <div class="button-rodeo">
                      <label>
                          <input type="checkbox" id="myonoffswitch1" value="on" onclick='B1P1(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
                <div class="inset">
                  <div class="port-no">2</div>  
                  <div class="button-rodeo">
                      <label>
                        <input type="checkbox" id="myonoffswitch2" value="on" onclick='B1P2(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
              <div class="inset">
                <div class="port-no">3</div>   
                <div class="button-rodeo">
                      <label>
                        <input type="checkbox" id="myonoffswitch3" value="on" onclick='B1P3(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
        </div>
    </div>
    <div class="list">
        <p class="txt">mic</p>
        <p class="txt">web cam</p>
        <p class="txt">xbox dongle</p>
    </div>
</div>
<div class="button-container">
    <p class="track-top">  control b  </p>
                               
    <div class="buttons"> 
        <div class="channel">
            <div class="inset">
                    <div class="port-no">1</div> 
                    <div class="button-rodeo">
                      <label>
                        <input type="checkbox" id="myonoffswitch4" value="on" onclick='B2P1(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
                <div class="inset">
                  <div class="port-no">2</div>  
                  <div class="button-rodeo">
                      <label>
                        <input type="checkbox" id="myonoffswitch5" value="on" onclick='B2P2(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
              <div class="inset">
                <div class="port-no">3</div>   
                <div class="button-rodeo">
                      <label>
                        <input type="checkbox" id="myonoffswitch6" value="on" onclick='B2P3(this);'></input>
                          <i></i>
                      </label>
                    </div>
                </div>
    </div>
</div>
<div class="list">
    <p class="txt">wacom</p>
    <p class="txt">phone</p>
    <p class="txt">vr headset</p>
</div>
</div>
<div class="button-container">
    <p class="track-top">  control c  </p>
    
    <div class="buttons"> 
                
        <div class="channel">
            <div class="inset">
                <div class="port-no">1</div> 
                <div class="button-rodeo">
                    <label>
                        <input type="checkbox" id="myonoffswitch7" value="on" onclick='B3P1(this);'></input>
                        <i></i>
                    </label>
                </div>
            </div>
            <div class="inset">
                <div class="port-no">2</div>  
                <div class="button-rodeo">
                    <label>
                        <input type="checkbox" id="myonoffswitch8" value="on" onclick='B3P2(this);'></input>
                        <i></i>
                    </label>
                </div>
            </div>
            <div class="inset">
                <div class="port-no">3</div>   
                <div class="button-rodeo">
                    <label>
                        <input type="checkbox" id="myonoffswitch9" value="on" onclick='B3P3(this);'></input>
                        <i></i>
                    </label>
                </div>
            </div>
    </div>
</div>
<div class="list">
    <p class="txt">front left VR Sensor</p>
    <p class="txt">front right VR Sensor</p>
    <p class="txt">rear left VR Sensor</p>
</div>
</div>
</div>
<div class="right-side">
<div class="key-container">
            <a class="key" onclick="load01();">bank 1</a>
            <a class="key" onclick="load02();">bank 2</a>
            <a class="key" onclick="load03();">bank 3</a>
                <div class="vl"></div>
            <a class="save" onclick="save01();">Save 1</a>
            <a class="save" onclick="save02();">Save 2</a>
            <a class="save" onclick="save03();">Save 3</a>
                <div class="vl"></div>
            <a class="off" onclick="uncheck();">OFF</a>
        </div>

</div>
</div>
</section>


<!--BEGIN RUNIFY CONTROL-->
<section class="APP" id="RUNIFY">
<div class="RUNIFY">
    
    <div class="login-container hidden" id="js-login-container">
        <button class="btn btn--login" id="js-btn-login">Login with Spotify</button>
      </div>
      <div class="main-container hidden" id="js-main-container"></div>
    
</div>
</section>
<!--END RUNIFY CONTROL-->



</div> <!--This is the scrolling wrapper end tag-->
</article>

    <!-- Bootstrap Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script src="./node_modules/@popperjs/core/dist/umd/popper.min.js"></script>
    <script src="./bootstrap/js/bootstrap.min.js"></script>
    <!--USB Save/Load script-->    
    <<script src="./usb-save-load.js"></script>
    <!--USB function toggle script-->
    <<script src="./usb-toggle-functions.js"></script>
    <!--Control side scrolling-->
    <script src="./navigation.js"></script>
    <!--Load RUNIFY script (Spotify wrapper)-->
    <script src="./RUNIFY/spotify-player.js"></script>
    





<script>
    if ( ! window.deferAfterjQueryLoaded ) {
    window.deferAfterjQueryLoaded = [];
    Object.defineProperty(window, "$", {
        set: function(value) {
            window.setTimeout(function() {
                $.each(window.deferAfterjQueryLoaded, function(index, fn) {
                    fn();
                });
            }, 0);
            Object.defineProperty(window, "$", { value: value });
        },

        configurable: true
    });
}

window.deferAfterjQueryLoaded.push(function() {

var mainContainer = document.getElementById('js-main-container'),
    loginContainer = document.getElementById('js-login-container'),
    loginButton = document.getElementById('js-btn-login'),
    background = document.getElementById('js-background');

var spotifyPlayer = new spotifyplayer();

var template = function (data) {
  return `
  <div class="screen-container">
  <div class="screen-display">
      <p class="song">${data.item.name}</p>
      <p class="artist">
          <span>${data.item.artists[0].name}</span>
          <span>-</span>
          <span>[ALBUM]</span>
          <span>[YEAR]</span>
      </p>
      <p class="prog-bar"><div class="progress__bar" style="width:${data.progress_ms * 100 / data.item.duration_ms}%"></div></p>
  </div>
  <div class="screen-buttons">
      <p class="audio-control-p"><button class="audio-control" id="switch">
        <div id="hide_id"></div>⏮︎</button></p>
      <p class="audio-control-p"><button class="audio-control" id="switch">
        <div id="hide_id"></div>▶⏸︎</button></p>
      <p class="audio-control-p"><button class="audio-control" id="switch">
        <div id="hide_id"></div>⏭︎</button></p>
      <p class="audio-control-p"><button class="audio-control" id="switch">
        <div id="hide_id"></div>❤</button></p>
  </div>
  
</div>
<div class="album-art-paneling">
  <div class="album-art-bg">
      <div class="album-art glass"><img src="${data.item.album.images[0].url}"></div>
  </div>    
</div>
  `;
};

var previousResponse = null;
spotifyPlayer.on('update', response => {
  mainContainer.innerHTML = template(response);
  if (previousResponse === null ||
    response.item.id !== previousResponse.item.id) {
    var options = {
      body: response.item.artists[0].name + ' — ' + response.item.album.name,
      icon: response.item.album.images[0].url
    }
    var n = new Notification(response.item.name, options);
    setTimeout(n.close.bind(n), 4000);
  }
  previousResponse = response;
});

spotifyPlayer.on('login', user => {
  if (user === null) {
    loginContainer.style.display = 'block';
    mainContainer.style.display = 'none';
  } else {
    loginContainer.style.display = 'none';
    mainContainer.style.display = 'block';
    Notification.requestPermission().then(function(result) {
      console.log(result);
    });
  }
});

loginButton.addEventListener('click', () => {
    spotifyPlayer.login();
});

spotifyPlayer.init();

});</script>
    
</body>
</html>
